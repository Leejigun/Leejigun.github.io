<!-- footer도 여기에 있음 -->


<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- iOS-tip 이라고 태그를 만들었으면 post에서는 iOS tip 이라고 태그를 줘야한다. -->
<!-- dynamically fixing the title for tag/author pages -->



    <title>[tensoflow 2.0] 4. 분류(Classification) 프로젝트</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="분류(Classification) 프로젝트" />
    <link rel="shortcut icon" href="https://leejigun.github.io//assets/images/blog-icon.png" type="image/png" />
    <link rel="canonical" href="https://leejigun.github.io//tensorflow2_4" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="iOS 삽질 블로그" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="[tensoflow 2.0] 4. 분류(Classification) 프로젝트" />
    <meta property="og:description" content="분류(Classification) 프로젝트 지도학습 (supervisor learning)의 문제 해결 방법은 2가지가 있다. 회귀 분류 앞서 선형 회귀를 통해서 다수의 입력으로 다수의 예측 결과를 가져오는 방법까지 학습했다. 여기서 더 나아가야 할 부분은 선형으로 표현할 수 있는 특성을 찾고 최적화 하기 위해서 가공하는 부분이 추가적으로 필요한데 그 부분은 머신러닝 단기 집중 과정에서 더 상세하게" />
    <meta property="og:url" content="https://leejigun.github.io//tensorflow2_4" />
    <meta property="og:image" content="https://leejigun.github.io//assets/images/ml/tensorflow2_4/background.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2019-12-06T09:00:03+09:00" />
    <meta property="article:modified_time" content="2019-12-06T09:00:03+09:00" />
    <meta property="article:tag" content="Ml" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="[tensoflow 2.0] 4. 분류(Classification) 프로젝트" />
    <meta name="twitter:description" content="분류(Classification) 프로젝트 지도학습 (supervisor learning)의 문제 해결 방법은 2가지가 있다. 회귀 분류 앞서 선형 회귀를 통해서 다수의 입력으로 다수의 예측 결과를 가져오는 방법까지 학습했다. 여기서 더 나아가야 할 부분은 선형으로 표현할 수 있는 특성을 찾고 최적화 하기 위해서 가공하는 부분이 추가적으로 필요한데 그 부분은 머신러닝 단기 집중 과정에서 더 상세하게" />
    <meta name="twitter:url" content="https://leejigun.github.io//" />
    <meta name="twitter:image" content="https://leejigun.github.io//assets/images/ml/tensorflow2_4/background.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="iOS 삽질 블로그" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Ml" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "iOS 삽질 블로그",
        "logo": "https://leejigun.github.io//assets/images/blog-icon.png"
    },
    "url": "https://leejigun.github.io//tensorflow2_4",
    "image": {
        "@type": "ImageObject",
        "url": "https://leejigun.github.io//assets/images/ml/tensorflow2_4/background.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://leejigun.github.io//tensorflow2_4"
    },
    "description": "분류(Classification) 프로젝트 지도학습 (supervisor learning)의 문제 해결 방법은 2가지가 있다. 회귀 분류 앞서 선형 회귀를 통해서 다수의 입력으로 다수의 예측 결과를 가져오는 방법까지 학습했다. 여기서 더 나아가야 할 부분은 선형으로 표현할 수 있는 특성을 찾고 최적화 하기 위해서 가공하는 부분이 추가적으로 필요한데 그 부분은 머신러닝 단기 집중 과정에서 더 상세하게"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="[tensoflow 2.0] 4. 분류(Classification) 프로젝트" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->

        <!-- HTML elements for search -->

        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <!-- 네비게이션 바 -->
<nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://leejigun.github.io//"><img src="/assets/images/blog-icon.png" alt="iOS 삽질 블로그" /></a>
            
        
        
            <!-- 여기서 navigation 에 표시할 이이템 추가 -->
<ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/ios-tip/">iOS tip</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/watchos/">watchOS</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/rxswift/">RxSwift</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/swiftui/">swiftui</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/project/">project</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/ml/">ML</a></li>
    <li class="nav-try-ghost" role="menuitem"><a href="https://github.com/Leejigun">github</a></li>
    <li class="nav-try-ghost" role="menuitem"><a href="/search.html">Search</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-getting-started ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 6 December 2019"> 6 December 2019</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/ml/'>ML</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">[tensoflow 2.0] 4. 분류(Classification) 프로젝트</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/ml/tensorflow2_4/background.png)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h1 id="분류classification-프로젝트">분류(Classification) 프로젝트</h1>

<p>지도학습 (supervisor learning)의 문제 해결 방법은 2가지가 있다.</p>

<ul>
  <li>회귀</li>
  <li>분류</li>
</ul>

<p>앞서 선형 회귀를 통해서 다수의 입력으로 다수의 예측 결과를 가져오는 방법까지 학습했다. 여기서 더 나아가야 할 부분은 선형으로 표현할 수 있는 특성을 찾고 최적화 하기 위해서 가공하는 부분이 추가적으로 필요한데 그 부분은 머신러닝 단기 집중 과정에서 더 상세하게 진행할 수 있을거 같다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled.png" alt="4%20Classification/Untitled.png" /></p>

<p>이제부터는 지도학습에서 문제를 해결하는 두번째 방법인 분류에 대해서 학습할 것이다.</p>

<p>분류는 일상생활에서 많이 쓰이고 머신러닝을 하는 대표적인 이유 중 하나이다.</p>

<p>특히 logistic regression은 앞으로 할 딥러닝의 뼈대가 될 중요한 개념이다.</p>

<h2 id="선형-회귀-정리">선형 회귀 정리</h2>

<p>선형 회귀에서는 먼저 가설을 설정해야 한다. 입력 값에 대한 출력 값의 관계를 표현할 수 있는 선을 찾고 그 선 중에서 가장 적합한 선을 찾는 과정이다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 1.png" alt="assets/images/ml/tensorflow2_4/Untitled 1.png" /></p>

<p>그 최소한의 손실을 찾기 위해서 제곱 손실을 통해서 손실값을 제곱한다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 2.png" alt="assets/images/ml/tensorflow2_4/Untitled 2.png" /></p>

<p>이 때 손실의 그래프에서 경사 하강법을 통해 가장 손실이 적은 부분을 찾아 나가는 과정을 가진다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 3.png" alt="assets/images/ml/tensorflow2_4/Untitled 3.png" /></p>

<h2 id="binary-classification">Binary Classification</h2>

<p>참이냐 거짓 이냐 2가지 라벨값을 분류하는 모델</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 4.png" alt="assets/images/ml/tensorflow2_4/Untitled 4.png" /></p>

<p>예를 들어 보스턴 마라톤 대회의 Qualify 하는 과정을 살펴본다면 페이스가 어느 정도가 되면 유효하고 그 이하가 되면 유효하지 않다고 판단할 수 있다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 5.png" alt="assets/images/ml/tensorflow2_4/Untitled 5.png" /></p>

<p>근데 이 때 적합한 페이스를 찾는 과정을 살펴보면 선형 회귀 방법과 유사하다.</p>

<p>페이스와 오피셜 타임의 관계를 보면 선형적인 관계를 가지고 있는 것으로 보인다.</p>

<p>따라서 특정 위치를 정해 그 이상의 데이터만 유효하다고 판단하게 할 수 있다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 6.png" alt="assets/images/ml/tensorflow2_4/Untitled 6.png" /></p>

<p>근데, 만약 참전 용사들이 다수 참가하게 되어 이상 데이터가 발생했다고 가정 해보자. 그러면 유효 하다고 판단되는 선을 정하기 힘들 것으로 보인다.</p>

<p>이런 이상값들 때문에 기준이 바뀔 수 있다. 선형 회귀에서는 의미있는 값이지만 분류에서는 이런 이상값 때문에 분류가 제대로 안될 수 있다.</p>

<p>이런 오류를 피하기 위해서 분류에서는 한계치를 정하고 그 한계를 넘어가는 값은 한계값으로 바꿔서 처리할 수 있다.</p>

<h3 id="sigmoid-함수">Sigmoid 함수</h3>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 7.png" alt="assets/images/ml/tensorflow2_4/Untitled 7.png" /></p>

<p>어떤 지점 이상이 되면 급격하게 감소하게되어 1이상이 되지 않고 어느 지점 이하가 되면 급격하게 증가해서 0밑으로 떨어지지 않게 된다.</p>

<p><a href="https://icim.nims.re.kr/post/easyMath/64">https://icim.nims.re.kr/post/easyMath/64</a></p>

<p>sigmoid 함수는 로지스틱 회귀분석 또는 Neural network의 Binary classification 마지막 레이어의 활성함수로 사용한다.</p>

<p>데이터를 두 개의 그룹으로 분류하는 문제에서 가장 기본적인 방법은 로지스틱 회귀분석이다. 회귀분석과의 차이는 회귀분석에서는 우리가 원하는 것이 예측값(실수)이기 때문에 종속변수의 범위가 실수이지만 로지스틱 회귀분석에서는 종속변수 y값이 0 또는 1을 갖는다. 그래서 우리는 주어진 데이터를 분류할 때 0인지 1인지 예측하는 모델을 만들어야 한다.</p>

<h3 id="가설">가설</h3>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 8.png" alt="assets/images/ml/tensorflow2_4/Untitled 8.png" /></p>

<h2 id="binary-classification-비용-최적화">Binary Classification 비용 최적화</h2>

<p>앞서 Sigmoid 함수를 사용해 바이너리 분류 가설을 세운다고 했다. 이제 가장 적당한 위치를 찾기 위해서 어떻게 해야 할까?</p>

<p>Linear Regression의 경우 오차를 제곱하기 때문에 빗나갈수록 점점 값이 증가한다.</p>

<p>하지만 Logistic의 경우에는 아래와 같이 구블구블한 형태가 된다. 따라서 여기가 제일 작은 값이라 생각했지만 더 작은 값이 있는 위치가 있을 수 있다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 9.png" alt="assets/images/ml/tensorflow2_4/Untitled 9.png" /></p>

<p>이를 해결하기 위해서 여러가지 방법이 있는데, 경사 하강법을 사용하지 않거나 이 구블구블한 부분을 펴줄 필요가 있다.</p>

<h3 id="log-함수를-통한-확장">Log 함수를 통한 확장</h3>

<p>급격히 증가하는 케이스에 log를 씌우면 급격히 감소한다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 10.png" alt="assets/images/ml/tensorflow2_4/Untitled 10.png" /></p>

<p>따라서 2가지 케이스에 맞춰 손실 함수를 구분해 사용한다.</p>

<ul>
  <li>y 가 1인 경우</li>
  <li>y가 0인 경우</li>
</ul>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 11.png" alt="assets/images/ml/tensorflow2_4/Untitled 11.png" /></p>

<p>y값이 1일 때 왼쪽 그래프를 보면 1에서 멀어질수록 값이 손실값이 커지게 된다.</p>

<p>y값이 0일 때 오른쪽 그래프를 보면 0에서 멀어질수록 손실값이 커진다.</p>

<p>따라서 y값에 맞춰서 다른 손실 함수를 사용한다면 경사 하강법을 적용할 수 있는 손실 함수를 구성할 수 있다.</p>

<p>다음 공식을 텐서 플로우1로 옮긴 코드다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 12.png" alt="assets/images/ml/tensorflow2_4/Untitled 12.png" /></p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 13.png" alt="assets/images/ml/tensorflow2_4/Untitled 13.png" /></p>

<h2 id="qualifying-여부-예측-모델-제작">Qualifying 여부 예측 모델 제작</h2>

<p>기존의 linear regression과 모댈 생성 부분이 조금 다르다.</p>

<p>우리가 이제 sigmoid 함수를 쓰기 때문에 <code class="highlighter-rouge">**activation='sigmoid'</code> 가 추가된다.**</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">#</span> <span class="n">Define</span> <span class="n">Sequential</span> <span class="k">model</span> <span class="k">and</span> <span class="n">Dense</span>
<span class="k">model</span> <span class="p">=</span>  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="k">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">=(</span><span class="m">3</span><span class="p">,),</span> <span class="n">activation</span><span class="p">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
</code></pre></div></div>

<p>손실 함수 역시 기존과 다르게 생성한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Use softmax  
# model.add(Activation('sigmoid'))
# Stochastic gradient descent (SGD) Optimizer
sgd = tf.keras.optimizers.SGD(lr=t_r)
# categorical_crossentropy loss function
model.compile(loss='binary_crossentropy',
              optimizer=sgd,
              metrics=['accuracy'])
</code></pre></div></div>

<p>하단 부분은 동일하다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># prints summary of the model to the terminal
model.summary()

# Train the model
history = model.fit(np.array(x_train), np.array(y_train), epochs=t_t)
</code></pre></div></div>

<p>테스트 결과는 다음과 같다.</p>

<p>Gender :Male, Age :24, Pace :297</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 14.png" alt="assets/images/ml/tensorflow2_4/Untitled 14.png" /></p>

<h2 id="multinomial-classification-개념">Multinomial Classification 개념</h2>

<p>이전에는 2가지 경우에 대해서만 분류하는 방법에 대해서 실습했는데, 이번에는 여러가지 태그에 대해서 분류하는 방법에 대해서 학습한다.</p>

<p>만약 개와 새와 고양이를 찾는 로직이 필요하다면 어떻게 해야할까?</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 15.png" alt="assets/images/ml/tensorflow2_4/Untitled 15.png" /></p>

<p>이렇게 개냐 아니냐, 새냐 아니냐, 고양이냐 아니냐로 3가지 바이너리 분류를 만들어 계산하면 쉽게 구할 수 있어 보인다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 16.png" alt="assets/images/ml/tensorflow2_4/Untitled 16.png" /></p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 17.png" alt="assets/images/ml/tensorflow2_4/Untitled 17.png" /></p>

<p>이 때의 손실함수는 어떻게 돌아갈까?</p>

<p>3가지의 데이터가 들어가고 3가지의 결과가 나온다. - 전체를 더하면 1이 되는 값으로 분류를 예상한다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 18.png" alt="assets/images/ml/tensorflow2_4/Untitled 18.png" /></p>

<p>각각의 확률값에 대해서 가장 확률이 높은 분류값을 1로 줄 수 있다.</p>

<h3 id="one---hot-encoding">One - Hot encoding</h3>

<p>딱 하나의 데이터만 1로 표시하는 것을 원핫 인코딩이라 한다.</p>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 19.png" alt="assets/images/ml/tensorflow2_4/Untitled 19.png" /></p>

<h2 id="기록등급-데이터-만든기">기록등급 데이터 만든기</h2>

<p>요구 사항은 다음과 같다.</p>

<ul>
  <li>M/F</li>
  <li>Age</li>
  <li>Pace</li>
</ul>

<p>3가지 데이터를 가지고 Grade를 예측해야 한다.</p>

<p>이를 위해서 데이터에 Grade를 추가해야 한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 마라톤 데이터를 읽어오고 모든 데이터에 Grade를 1로 준다.
marathon_2015_2017_qualifying = pd.read_csv("./data/marathon_2015_2017_qualifying.csv")
marathon_2015_2017_qualifying["Grade"] = 1

# 그리고 이 데이터의 요약을 뽑는 함수 describe를 사용해 요약된 정보를 담는다.
statistics_2015_2017 = marathon_2015_2017_qualifying["Official Time"].describe()
</code></pre></div></div>

<p>이 때 요약 정보는 다음과 같다.</p>

<hr />

<p>count 79638.000000
mean 13989.929167
std 2492.272069
min 7757.000000
25% 12258.000000
50% 13592.000000
75% 15325.000000
max 37823.000000
Name: Official Time, dtype: float64</p>

<hr />

<p>이제 이 데이터의 25% 값보다 낮은 값은 Grade를 0으로 75% 보다 높은 값은 2로 줘서 0~2 사이의 Grade 값을 줬다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 25퍼 값보다 작으면 값을 0으로 75프로 값보다 크면 값을 2로 바꿔준다.
marathon_2015_2017_qualifying.loc[marathon_2015_2017_qualifying["Official Time"] &lt;
 statistics_2015_2017["25%"], "Grade"] = 0
marathon_2015_2017_qualifying.loc[marathon_2015_2017_qualifying["Official Time"] &gt;
 statistics_2015_2017["75%"], "Grade"] = 2
</code></pre></div></div>

<p>그리고 데이터를 학습 데이터와 테스트 데이터로 나누는 행위는 앞서와 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>marathon_2015_2016 = marathon_2015_2017_qualifying[marathon_2015_2017_qualifying['Year'] != 2017]
marathon_2017 = marathon_2015_2017_qualifying[marathon_2015_2017_qualifying['Year'] == 2017]

df_2015_2016 = pd.DataFrame(marathon_2015_2016,columns=['M/F',  'Age',  'Pace',  'Grade'])
df_2017 = pd.DataFrame(marathon_2017,columns=['M/F',  'Age',  'Pace',  'Grade'])

# Dataframe to List
record_2015_2016 = df_2015_2016.values.tolist()
record_2017 = df_2017.values.tolist()
</code></pre></div></div>

<p>학습 모델에서 조금 차이가 있다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">#</span> <span class="n">Define</span> <span class="n">Sequential</span> <span class="k">model</span> <span class="k">and</span> <span class="n">Dense</span>
<span class="k">model</span> <span class="p">=</span>  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="p">#</span> <span class="m">3</span><span class="err">개의</span> <span class="err">입력값으로</span> <span class="m">3</span><span class="err">가지</span> <span class="err">출력값이</span> <span class="err">나올</span> <span class="err">수</span> <span class="err">있기</span> <span class="err">때문에</span> <span class="m">3</span><span class="err">을</span> <span class="err">입력한다</span><span class="p">.</span>
<span class="k">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">=(</span><span class="m">3</span><span class="p">,),</span> <span class="n">activation</span><span class="p">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="p">#</span> <span class="n">Stochastic</span> <span class="n">gradient</span> <span class="n">descent</span> <span class="p">(</span><span class="n">SGD</span><span class="p">)</span> <span class="n">Optimizer</span>
<span class="n">sgd</span> <span class="p">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="p">=</span><span class="n">t_r</span><span class="p">)</span>
</code></pre></div></div>

<p>손실 함수도 다른 함수를 사용해야 한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 카테고리의 손실 함수를 위해 categorical_crossentropy 사용
model.compile(loss='categorical_crossentropy',
                  optimizer=sgd,
                  metrics=['accuracy'])
</code></pre></div></div>

<p>그리고 특히 중요한 부분으로 원핫 인코딩 작업을 해주는 함수가 있다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># One hot encode [0, 1, 2] to [[1,0,0], [0,1,0], [0,0,1]]
# 원핫 인코딩을 아주 쉽게 사용 가능하다.
y_one_hot = tf.keras.utils.to_categorical(y_train)
</code></pre></div></div>

<p>만약 y값 (grade) 가 1이라면 [0,1,0] 으로 데이터를 변경한다.</p>

<ul>
  <li>0 ⇒ [1, 0, 0]</li>
  <li>1 ⇒ [0, 1, 0]</li>
  <li>2 ⇒ [0, 0, 1]</li>
</ul>

<p>로깅 부분에서는 손실값과 우리가 matics에서 정의한 정확도(accuracy) 값을 출력하도록 한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for step in range(t_t):
	if step % 100 == 0:
	    cost_val = history.history['loss'][step]
	    a_val = history.history['accuracy'][step]
	    log_ScrolledText.insert(END, "%10i %20.5f %20.7f" % (step, cost_val, a_val*100)+'\n')
</code></pre></div></div>

<p><img src="assets/images/ml/tensorflow2_4/Untitled 20.png" alt="assets/images/ml/tensorflow2_4/Untitled 20.png" /></p>

<hr />

<p>회귀는 마스터한거 같은데 분류 부분은 아직 잘 모르겠다.</p>

<p>더 학습과 실습이 필요하다.</p>

<p>이 분류 부분은 딥러닝에서도 사용한다고 하니 나중에 다시 살펴보자.</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = 'https://leejigun.github.io//';
                            this.page.identifier = 'iOS 삽질 블로그';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://jglee.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; iOS 삽질 블로그 &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/ml/">Ml</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/titanic_3">[Kaggle] titanic 모델, 예측, 해결</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/titanic_2">[Kaggle] titanic 데이터 가공</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/titanic_1">[Kaggle] titanic 데이터 분석</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/ml/">
                                
                                    See all 18 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/tensorflow2_5">
                <div class="post-card-image" style="background-image: url(/assets/images/ml/tensorflow2_5/background.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/tensorflow2_5">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Ml</span>
                            
                        
                    

                    <h2 class="post-card-title">[tensoflow 2.0] 5. 머신러닝 최적화</h2>
                </header>
                <section class="post-card-excerpt">
                    <p># 머신러닝 최적화 ## Overshooting 경사 하강법을 사용하면서 우리는 조금 조금씩 아래로 내려오면서 수렴하는 지점을 찾아 나간다. 근데 만약 learning rate 값이 너무 크면 수렴하는 지점을 넘어가게 된다. 아래와 같이 learning rate가 너무</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/tensorflow2_3">
                <div class="post-card-image" style="background-image: url(/assets/images/ml/tensorflow2_3/background.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/tensorflow2_3">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Ml</span>
                            
                        
                    

                    <h2 class="post-card-title">[tensoflow 2.0] 3. 회귀 프로젝트</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>회귀 프로젝트 [텐서플로우2] - 마라톤 남은 기록 예측 모델 만들기 앞서 마라톤 데이터를 가져와 텐서플로우 1을 사용해 선형 회귀를 구현한 모델이 있었다. tensorflow 1 linear regression 이제 여기서 learning 부분을 수정해본다. 기존 learning</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://leejigun.github.io//">
            
                <img src="/assets/images/blog-icon.png" alt="iOS 삽질 블로그 icon" />
            
            <span>iOS 삽질 블로그</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">[tensoflow 2.0] 4. 분류(Classification) 프로젝트</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%5Btensoflow+2.0%5D+4.+%EB%B6%84%EB%A5%98%28Classification%29+%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8&amp;url=https://leejigun.github.io/tensorflow2_4"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://leejigun.github.io/tensorflow2_4"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://leejigun.github.io//">iOS 삽질 블로그</a> &copy; 2020</section>
                <section class="poweredby">Github page blog of <a href="https://github.com/Leejigun">Leejigun</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <!-- <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a> -->
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-154736789-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
